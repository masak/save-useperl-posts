<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
            "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="shortcut icon" href="//use.perl.org/favicon.ico">

<title>Journal of masak (6289)</title>

<link rel="stylesheet" type="text/css" media="screen, projection" href="//images.use.perl.org/base.css?T_2_5_0_235">
<link rel="stylesheet" type="text/css" media="screen, projection" href="//images.use.perl.org/comments.css?T_2_5_0_235">
<link rel="stylesheet" type="text/css" media="screen, projection" href="//images.use.perl.org/useperl.css?T_2_5_0_235">
<link rel="stylesheet" type="text/css" media="print" href="//images.use.perl.org/print.css?T_2_5_0_235">
<link rel="stylesheet" type="text/css" media="handheld" href="//images.use.perl.org/handheld.css?T_2_5_0_235">

<script src="//images.use.perl.org/jquery/jquery-1.2.6.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/jquery/jquery.metadata.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/slash.util.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/jquery/jquery.slashdot.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/yahoo.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/dom.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/event.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/dragdrop.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/animation.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/yui/calendar.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/sd_calendar.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/slash.article-info.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/tag-ui.js?T_2_5_0_235" type="text/javascript"></script>
<script src="//images.use.perl.org/common.js?T_2_5_0_235" type="text/javascript"></script>

<!-- start template: ID 121, header;misc;default -->

<link rel="top"       title="All the Perl that's Practical to Extract and Report" href="//use.perl.org/" >
<link rel="search"    title="Search use Perl" href="//use.perl.org/search.pl">
<link rel="author"    title="masak" href="//use.perl.org/~masak/">
<link rel="alternate" title="masak's Journal RSS" href="http://use.perl.org/~masak/journal/rss" type="application/rss+xml">
<link rel="alternate" title="masak's Friends' Journals RSS" href="http://use.perl.org/~masak/journal/friends/rss" type="application/rss+xml">
<link rel="alternate" title="Most Recent Journals RSS" href="//use.perl.org/journal.pl?op=top&amp;content_type=rss" type="application/rss+xml">
<link rel="alternate" title="Most Active Journals RSS" href="//use.perl.org/journal.pl?op=top&amp;type=count&amp;content_type=rss" type="application/rss+xml">
<link rel="alternate" title="Most Befriended Journals RSS" href="//use.perl.org/journal.pl?op=top&amp;type=friends&amp;content_type=rss" type="application/rss+xml">
<link rel="alternate" title="use Perl RSS" href="//use.perl.org/index.rss" type="application/rss+xml">
</head>
<body class="useperlorg">
<div id="top_parent"></div>

<div id="jump">
	<a href="#main-articles">Stories</a>
	<br>
	<a href="#blocks">Slash Boxes</a>
	<br>
	<a href="#comments">Comments</a>
</div>
<div class="ad1">

</div>
<div id="frame">

<!-- UsePerl Ad Start -->
<div class="ad1"><!-- ad position 1 -->
<div id="fad1" style="text-align:center">
<!-- DoubleClick Ad Tag 1 -->
<script type="text/javascript">
	dfp_ord=Math.random()*10000000000000000;
	dfp_tile = 1;

	document.write('<script type="text/javascript" src="http://ad.doubleclick.net/adj/ostg.useperl/mainpage_p1_leader;pg=index;logged_in=0;tile='+dfp_tile+';ord='+dfp_ord+'?"><\/script>');
	dfp_tile++;
</script>
</div>
<!-- End DoubleClick Ad Tag 1 --></div>
<!-- UsePerl Ad End -->

	<div id="topnav">
		<div id="logo">
			<h1>
				<a href="//use.perl.org">use Perl</a>
			</h1>
		</div>
                <div class="search">
			<form method="get" action="//use.perl.org/search.pl">
				<fieldset>
					<legend></legend>
					<label>Search <strong>use Perl</strong></label>
					<input type="text" name="query" value="" size="20">
					<input type="submit" value="Go" class="button">
				</fieldset>
			</form>
		</div>
	</div>
	<div id="slogan">
		<h2>
			All the Perl that's Practical to Extract and Report
		</h2>
	</div>
	<div id="journalnav">
		<div id="links">
			

<!-- start template: ID 474, sidebox;misc;default -->

<div class="block">
	<div class="title" id="navigation-title">
		<h4>
			Navigation
		</h4>
	</div>
	<div class="content" id="navigation-content">
		<ul>
	<li class="begin">
		<a href="//use.perl.org/faq.shtml">FAQ</a>
	</li>
	<li>
		<a href="//use.perl.org/about.shtml">About</a>
        </li>
        <li>
		<a href="//use.perl.org/submit.pl">Submit Story</a>
        </li>
        <li>
		<a href="//use.perl.org/search.pl">Older Stories</a>
        </li>
        <li>	
		<a href="//use.perl.org/topics.shtml">Topics</a>
        </li>
        <li>
		<a href="//use.perl.org/pollBooth.pl">Polls</a>
        </li>
        <li>
		<a href="//use.perl.org/journal.pl">Journals</a>
        </li>
        <li>
		<a href="//use.perl.org/authors.pl">Authors</a>
        </li>
        <li>
		<a href="//use.perl.org/modulelist/">New Modules</a>
        </li>
        <li>
		<a href="//use.perl.org/users.pl?op=edithome">Preferences</a>

        </li>
</ul>
	</div>
</div>

<!-- end template: ID 474, sidebox;misc;default -->


		</div>
	</div>
	<div id="contents">
		
		<div id="journal">

<!-- end template: ID 121, header;misc;default -->



<!-- start template: ID 55, journalhead;journal;default -->

<div id="slashboxes">

<!-- start template: ID 474, sidebox;misc;default -->

<div class="block">
	<div class="title" id="userlogin-title">
		<h4>
			use Perl Log In
		</h4>
	</div>
	<div class="content" id="userlogin-content">
		
			<form action="//use.perl.org/login.pl" method="post">
<fieldset>
	<legend>Log In</legend>
	<label>
		Nickname
	</label>
	<input type="text" name="unickname" size="20" value="">
	<label>
		Password
	</label>
	<input type="hidden" name="returnto" value="//use.perl.org/">
	<input type="hidden" name="op" value="userlogin">
	<input type="password" name="upasswd" size="20">
	<label class="checkbox">
		<input type="checkbox" name="login_temp" value="yes">
		Public Terminal
	</label>
	<input type="submit" name="userlogin" value="Log in" class="button">
	</fieldset>
</form>
<p>
	[ <b>
		<a href="//use.perl.org/login.pl?op=newuserform">
			Create a new account
		</a>
	</b> ]
</p>
		
	</div>
</div>

<!-- end template: ID 474, sidebox;misc;default -->



<!-- start template: ID 474, sidebox;misc;default -->

<div class="block">
	<div class="title" id="user-info-title">
		<h4>
			masak (6289)
		</h4>
	</div>
	<div class="content" id="user-info-content">
		<a href="//use.perl.org/~masak/">masak</a> <br>&nbsp;&nbsp;(email not shown publicly)<br><a href="http://masak.org/carl" rel="nofollow">http://masak.org/carl</a><br><hr>Been programming Perl since 2001. Found Perl 6 somewhere around 2004, and fell in love. Now developing November (a Perl 6 wiki), Druid (a Perl 6 board game), pls (a Perl 6 project installer), GGE (a regex engine), and Yapsi (a Perl 6 implementation). Heavy user of and irregular committer to Rakudo.
	</div>
</div>

<!-- end template: ID 474, sidebox;misc;default -->


</div>
<div id="users-blocks">


<!-- start template: ID 376, tabbedmenu;misc;default -->



<!-- end template: ID 376, tabbedmenu;misc;default -->

<div class="generaltitle" >
	<div class="title">
		<h3 >
			<a href="//use.perl.org/~masak/journal/">Journal</a> of <a href="//use.perl.org/~masak/">masak</a> (6289)
			
		</h3>
	</div>
</div>


<div id="usermenu">
<ul class="menu">
<li><span class="begin"><a href="//use.perl.org/~masak/" class="begin">Info</a></span></li><li class="selected"><b><a href="//use.perl.org/~masak/journal/">Journal</a></b></li><li><a href="//use.perl.org/~masak/firehose/">Firehose</a></li><li><a href="//use.perl.org/~masak/friends/">Friends</a></li><li><a href="//use.perl.org/~masak/fans/">Fans</a></li><li><a href="//use.perl.org/~masak/foes/">Foes</a></li><li><a href="//use.perl.org/~masak/freaks/">Freaks</a></li><li><a href="//use.perl.org/~masak/tags/">Tags</a></li><li><a href="//use.perl.org/~masak/bookmarks/" class="end">Bookmarks</a></li>
</ul>
</div><div class="generalbody">

<!-- start template: ID 376, tabbedmenu;misc;default -->

<ul class="menu">
<li><span class="begin"><a href="//use.perl.org/journal.pl?op=top" class="begin">Top&nbsp;10</a></span></li><li><a href="//use.perl.org/journal.pl?op=friends" class="end">Friend's&nbsp;Journals</a></li>
</ul>

<!-- end template: ID 376, tabbedmenu;misc;default -->

<!-- end template: ID 55, journalhead;journal;default -->



<!-- start template: ID 65, slashdot;journal;default -->

<div id="journalslashdot">
    
	<div class="journaldate">Tuesday September 01, 2009</div>
	
	<div class="details">05:55 PM</div>
	<div class="title">
		<h3>An introduction to maze-making (in Literate Perl 6)</h3>
	</div>
	<div class="adminoptions">
		[

			<a href="//use.perl.org/~masak/journal/39568">#39568</a>
		]
	</div>

	<div class="intro"><p>When I was younger and programmed in BASIC, there were some programs I kept
coming back to, writing them many times over, each time with small variations.
It was a part of my autodidactic journey towards programmerhood &#8212; understanding
algorithms, patterns, code smells and coding common sense by writing things
over and over again.</p><p>One particular type of program I wrote was a program that drew <a href="http://en.wikipedia.org/wiki/Labyrinth" rel="nofollow">labyrinths</a>.</p><p>I still remember the different mode numbers for switching to graphic modes in
<a href="http://en.wikipedia.org/wiki/Turbo_Basic" rel="nofollow">Turbo Basic</a> and <a href="http://en.wikipedia.org/wiki/QBasic" rel="nofollow">QBasic</a>: <code>SCREEN 7</code>
switched to 320x200x16 EGA graphics, while <code>SCREEN 8</code> gave you
640x200x16 (and thus, quite non-quadratic pixels). <code>SCREEN 9</code> and
<code>SCREEN 12</code> provided even higher resolutions... but it wasn't the
resolution that was the attractive part for me. It was speeding up the
algorithm.</p><p>By the time I finally learned about <a href="http://en.wikipedia.org/wiki/Big_O_notation" rel="nofollow">Big O notation</a>, it made
perfect sense due to experiences such as those I had with my labyrinth
programs. In this post, I'll explain not only why my programs were slow, but
how I later learned about real algorithms and data structures, went back and
made my program fast, and found total happiness.</p><p>To make sure we're on the same page, let me specify what it is my programs did.
They built labyrinths which looked <a href="http://masak.org/carl/labyrint.txt" rel="nofollow">like this</a>. It's an <code>m</code>
by <code>n</code> grid of <code>N</code> cells, totally surrounded by walls,
and with internal walls making sure there's exactly one way through the
structure from the lower left to the upper right. Each internal wall (that is,
each wall which is not part of the surrounding border) faces two cells. The
cells in themselves are wholly uninteresting; the information lies in which
walls are solid and which are passages.</p><p>

<code>&gt;&nbsp;class&nbsp;Cell&nbsp;{}<br>
&gt;<br>
&gt;&nbsp;class&nbsp;Wall&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Cell&nbsp;$!cell1;<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Cell&nbsp;$!cell2;<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Bool&nbsp;$.solid&nbsp;=&nbsp;True;<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;true()&nbsp;{&nbsp;$.solid&nbsp;}&nbsp;#&nbsp;this&nbsp;way,&nbsp;walls&nbsp;boolify&nbsp;to&nbsp;$.solid<br>
&gt;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;class&nbsp;Labyrinth&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Int&nbsp;$!height;<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Int&nbsp;$!width;<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Wall&nbsp;@!vertical-walls;<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Wall&nbsp;@!horizontal-walls;<br>
&gt;&nbsp;}<br>
</code>

</p><p>When a program builds the labyrinth, it can start with an empty grid and keep
adding walls, making sure that at least one way through the labyrinth remains.
Another way to build a labyrinth to start with all walls in place, and
then selectively remove walls, with the constant criterion that we do not
introduce more than one passage through the whole labyrinth. In some sense,
these approaches are duals to each other and equivalent. In this post, I will
choose the latter approach, since that's how I've come to think about the
algorithm.</p><p>So here's the general recipe we're going to follow: we start with all walls in
place, and then randomly remove walls, with the added criterion that a wall is
kept if removing it would introduce a second path through the labyrinth. This
"second path" criterion can be reformulated like so: if we're about to remove
some wall, which happens to lie between cells A and B, and our only concern is
that we don't want to introduce multiple paths through the labyrinth, we're
allowed to remove the wall if and only if cells A and B aren't already
connected by some other means.</p><p>

<code>&gt;&nbsp;class&nbsp;Labyrinth&nbsp;is&nbsp;also&nbsp;{&nbsp;#&nbsp;RAKUDO:&nbsp;Should&nbsp;be&nbsp;'augment&nbsp;class'<br>
&gt;&nbsp;&nbsp;&nbsp;submethod&nbsp;BUILD&nbsp;(Int&nbsp;:$height,&nbsp;Int&nbsp;:$width)&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!height&nbsp;=&nbsp;$height;&nbsp;&nbsp;#&nbsp;RAKUDO:&nbsp;S06/Attributive&nbsp;parameters<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!width&nbsp;&nbsp;=&nbsp;$width;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&lt;Int&nbsp;:$!height,&nbsp;Int&nbsp;:$!width&gt;<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.init-cells-and-walls();<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;@.random-wall-order&nbsp;-&gt;&nbsp;$wall&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;$wall.separates-different-areas()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$wall.remove();<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>It's this connectedness check that kills performance. At least it did for me in
my teens. My programs used a metaphoric bucket of paint to mark cell A, and
then the unpainted neighbours of cell A, and all their unpainted neighbours,
and so on... until they either ran into cell B (at which point we know that A
and B are connected), or they ran out of new neighbours to paint (at which
point we know that A and B belong to distinct graph components). After each
such painting spree, all cells were metaphorically scrubbed clean, so that the
next round of painting would start from a clean slate.</p><p>Some big-O analysis explains why this method is slow. We want to try and remove
each wall exactly once, so that's one connectedness check per wall. Such a
check needs to traverse a bunch of cells, in the worst case all cells in the
labyrinth. Painting a cell takes constant time, so checking if A and B are
connected takes O(<code>N</code>) time units, <code>N</code> being the number
of cells in the labyrinth.</p><p>That's for one wall; the number of walls is proportional to the number of
cells, so that's an outer loop with O(<code>N</code>) iterations each doing the
O(<code>N</code>)-unit connectedness check. In toto, the tearing down of walls
takes O(<code>N&#178;</code>) time units.  That's too slow.</p><p>(Why is it too slow? To get a feeling for what the O(<code>N&#178;</code>) tells us,
consider that doubling the number of cells in the labyrinth would make it four
times as slow. And that's doubling the <em>cells</em>, not one of the sides.
Were we to double both the height and the width of the labyrinth, it would have
four times as many cells, and the algorithm would be <em>sixteen</em> times as
slow. Exponents kill.)</p><p>My next idea was to label each cell with its own group number, and each time I
removed a wall, I'd let the cells on one side assimilate those on the other
side, so that the cells on both sides had the same group number. With this
method, the connectedness checking was cheap, but the <em>joining of
groups</em> suddenly took O(<code>N</code>) time units, as all the cells of one
group had to be traversed and relabeled. In rethinking the problem, I had lost
as much performance as I had won. Some hidden waterbed theory of minimal time
complexity seemed to have bitten me. At this point, I faltered and failed to
glimpse the beautiful solution, discussed below.</p><p>I called a few utility submethods in my <code>BUILD</code> method above, which
I haven't defined. They're not algorithmically challenging, but shoving them
away in their own submethods makes the <code>BUILD</code> submethod so much
more readable.</p><p>

<code>&gt;&nbsp;class&nbsp;Labyrinth&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;init-cells-and-walls()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@cells&nbsp;=&nbsp;map&nbsp;{&nbsp;[map&nbsp;{&nbsp;Cell.new()&nbsp;},&nbsp;^$!width]&nbsp;},&nbsp;^$!height;<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@!vertical-walls&nbsp;=<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;-&gt;&nbsp;$row&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;-&gt;&nbsp;$column&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wall.new(:cell1(@cells[$row][$column]),<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cell2(@cells[$row][$column+1]))<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;^($!width-1)&nbsp;#&nbsp;off-by-one&nbsp;--&nbsp;internal&nbsp;walls<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;^$!height<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@!horizontal-walls&nbsp;=<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;-&gt;&nbsp;$row&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map&nbsp;-&gt;&nbsp;$column&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Wall.new(:cell1(@cells[$row][$column]),<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cell2(@cells[$row+1][$column]))<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;^$!width<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;^($!height-1)&nbsp;&nbsp;#&nbsp;off-by-one&nbsp;--&nbsp;internal&nbsp;walls<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>By the way, I hope I'm not shocking you too much with those <code>map</code>
blocks. In Perl 6, <code>map</code> and <code>for</code> are semantically
equivalent. When I want to functionally transform a list of things, I still
prefer <code>map</code>.</p><p>

<code>&gt;&nbsp;class&nbsp;Labyrinth&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;submethod&nbsp;random-wall-order()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(@!vertical-walls,&nbsp;@!horizontal-walls).pick(*);<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>I'm translating this code from a Java program I had lying around. The
corresponding Java method was a bit longer than the above. &#21704;&#21704;</p><p>Now for the big revelation of this post: we can do better than the
O(<code>N&#178;</code>) calculated above, and with the addition of one simple trick.
No matter what we do, the O(<code>N</code>) walls still have to be traversed,
but if we can somehow reduce both the connectedness test and the joining of
groups to constant time &#8212; <em>constant time!</em> &#8212; the whole thing would only
take O(<code>N</code>) time units.</p><p>This is where the theory comes in. A few summers ago, I was basking in the sun
on a piece of grass outside of a university building, reading Knuth's <a href="http://www-cs-faculty.stanford.edu/~knuth/taocp.html" rel="nofollow">TAOCP</a>. At one
point, he discusses <a href="http://en.wikipedia.org/wiki/Equivalence_class" rel="nofollow">equivalence classes</a>,
and how the operations of joining and comparing members can be made efficient.
It all hinged on each member of the equivalence class having the option to
delegate decision-making to another member, one more central to the
decision-making process (call it a "leader").</p><p>How are equivalence classes related to labyrinths, you ask? Well, that's the
beauty of mathematics: all it does is provide us with tools to solve problems
better. If we find a way to apply the tools to our problem space, it's like
someone already did all the work for us. Specifically, if we can show that "A
is connected with B" is an <a href="http://en.wikipedia.org/wiki/Equivalence_relation" rel="nofollow">equivalence
relation</a>, we can think of each set of communicating cells in the labyrinth
as an equivalence class, and then apply Knuth's trick to the program to make it
fast.</p><p>What does it take to show that "A is connected with B" forms an equivalence
relation? An equivalence relation <code>~</code> has to satisfy three
properties: reflexivity, symmetry and transitivity. Or, in mathese, for any
members x, y and z, (1) <code>x ~ x</code>, (2) <code>x ~ y &#8660; y ~ x</code>, (3)
<code>x ~ y &amp; y ~ z &#8658; x ~ z</code>.  (Math alert: if I just lost you in a cloud
of boolean incantations, fear not!  What the symbols represent is not
difficult, but neither are the symbols self-evident. The rest of the post can
be understood without this paragraph.) But all these happen to hold for our
connectedness relation: cells are connected to themselves; if one is connected
to another, the other is connected to the first; and if one is connected to a
second which is connected to a third, the first must be connected to the third
as well. QED.</p><p>Ok, so we're good to go. To make this work, each cell needs to keep track of
which leader cell it delegates to. Each cell starts out without a leader,
signified by the attribute being <code>undef</code>.</p><p>

<code>&gt;&nbsp;class&nbsp;Cell&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;has&nbsp;Cell&nbsp;$.leader&nbsp;is&nbsp;rw;<br>
&gt;&nbsp;}<br>
</code>

</p><p>Cells with a leader delegate all their decisions (such as answering questions
about connectedness) to that leader. In fact, since this may be done in several
steps, we eventually end up with trees of cells, each tree with one cell at the
root node which gets to make all the decisions. We call that cell the
<i>boss</i>. We're never really interested in the middle managers, and in fact
we can remove them as we find them, creating a totally flat hierarchy.</p><p>

<code>&gt;&nbsp;class&nbsp;Cell&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;boss()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defined&nbsp;$!leader&nbsp;??&nbsp;($!leader&nbsp;=&nbsp;$!leader.boss())&nbsp;!!&nbsp;self<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;join(Cell&nbsp;$other-cell)&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$other-cell.leader&nbsp;=&nbsp;self;<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>In words: to know who my boss is, ask my leader who its boss is. Make that my
new boss. (That way, the hierarchy keeps flattening out.) If I don't have a
leader, I'm my own boss. To join with another cell, tell it that I'm its leader
now.</p><p>With the introduction of bosses, the connectedness and joining steps are easy
to implement. This is more or less directly from Knuth's TAOCP, by the way:</p><p>

<code>&gt;&nbsp;class&nbsp;Wall&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;separates-different-areas&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!cell1.boss()&nbsp;!===&nbsp;$!cell2.boss();<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;remove()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!cell1.boss().join(&nbsp;$!cell2.boss()&nbsp;);<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!solid&nbsp;=&nbsp;False;<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>These two methods sure <em>look</em> fast, but how can we be sure? Maybe the<nobr> <wbr></nobr><code>.boss</code> calls take O(<code>N</code>) time units each, bringing the
total running performance down to O(<code>N&#178;</code>) again... but the<nobr> <wbr></nobr><code>.boss</code> calls turn out to be very fast in practice. For one thing,
we're no longer traversing all the cells within the same equivalence class;
we're just taking the shortest route to the cell in charge. Secondly, we're
even short-circuiting that route to one single step, so that subsequent
traversals through the same path will be faster. The result is that the<nobr> <wbr></nobr><code>.boss</code> calls run in (<a href="http://en.wikipedia.org/wiki/Amortized_analysis" rel="nofollow">amortized</a>) constant
time, making the total running time O(<code>N</code>).</p><p>[<b>Update 2010-02-20:</b> The above analysis is slightly weak, and doesn't tell the whole story, which I discovered only later by tips from others. If you're interested, you could start from the Wikipedia article on <a href="http://en.wikipedia.org/wiki/Disjoint-set_data_structure" rel="nofollow">Disjoint-set data structures</a>.]</p><p>And that's it! Well, um, we might want to print our labyrinth at some point.
Stringifying a two-dimensional structure is not a pretty thing; there's too
much going on, and the code looks nothing like the result. So please close
your eyes (or look the other way) while reading this part:</p><p>

<code>&gt;&nbsp;class&nbsp;Labyrinth&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;Str()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;($h,&nbsp;$v)&nbsp;=&nbsp;0,&nbsp;0;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$s&nbsp;=&nbsp;'+--'&nbsp;x&nbsp;($!width-1)&nbsp;~&nbsp;"+&nbsp;&nbsp;+\n";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;upper&nbsp;wall<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;^$!height&nbsp;-&gt;&nbsp;$row&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;'|&nbsp;&nbsp;';&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;left&nbsp;wall<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;^($!width-1)&nbsp;-&gt;&nbsp;$column&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;@!vertical-walls[$v++]&nbsp;??&nbsp;'|'&nbsp;!!&nbsp;'&nbsp;';&nbsp;&nbsp;#&nbsp;inner&nbsp;v&nbsp;walls<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;'&nbsp;&nbsp;';<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;"|\n";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;right&nbsp;wall<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;[~]&nbsp;map&nbsp;-&gt;&nbsp;$column&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$row&nbsp;==&nbsp;$!height-1&nbsp;&amp;&amp;&nbsp;$column&nbsp;!=&nbsp;0&nbsp;#&nbsp;bottom&nbsp;wall<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||&nbsp;@!horizontal-walls[$h++]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;inner&nbsp;h&nbsp;walls<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;??&nbsp;'+--'<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;!!&nbsp;'+&nbsp;&nbsp;'<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;^$!width;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s&nbsp;~=&nbsp;"+\n";<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$s;<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>Now we can simply print out an instance of a <code>Labyrinth</code>, and watch
the fruits of our work.</p><p>

<code>&gt;&nbsp;my&nbsp;$labyrinth&nbsp;=&nbsp;Labyrinth.new(&nbsp;:height(10),&nbsp;:width(10)&nbsp;);<br>
&gt;&nbsp;say&nbsp;$labyrinth;<br>
</code>

</p><p> <i>This blog post is written in "Literate Perl 6", inspired by several blog
posts in <a href="http://www.haskell.org/haskellwiki/Literate_programming" rel="nofollow">Literate
Haskell</a> that I've seen over the years. If you have the module <a href="http://github.com/masak/perl6-literate" rel="nofollow">Perl6::Literate</a> installed,
you can paste this whole blog post to a file, and run the file with<nobr> <wbr></nobr><code>./perl6-literate &lt;pastefile.lpl&gt;</code>. Your reward will be a
reasonably quickly generated labyrinth. On my computer, running the blog post
that way takes 31 seconds, 23 out of which are spent in parsing and converting,
and 8 in actually making the labyrinth.</i> </p><p>I promised moritz_++ to make something pretty with SVG as well, so here's an
SVG serializer for the labyrinth:</p><p>

<code>&gt;&nbsp;use&nbsp;SVG;&nbsp;#&nbsp;requires&nbsp;the&nbsp;SVG.pm&nbsp;module,&nbsp;'proto&nbsp;install&nbsp;svg'<br>
&gt;<br>
&gt;&nbsp;class&nbsp;Labyrinth&nbsp;is&nbsp;also&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;method&nbsp;svg()&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$f&nbsp;=&nbsp;20;&nbsp;#&nbsp;scaling&nbsp;factor<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;@walls;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$style&nbsp;=&nbsp;'stroke:black;stroke-width:1px;fill:none';<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$v&nbsp;=&nbsp;0;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;^$!height&nbsp;X&nbsp;^($!width-1)&nbsp;-&gt;&nbsp;$r,&nbsp;$c&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;@!vertical-walls[$v++]&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$d&nbsp;=&nbsp;sprintf&nbsp;'M&nbsp;%d&nbsp;%d&nbsp;L&nbsp;%d&nbsp;%d',<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($c+1)&nbsp;*&nbsp;$f,&nbsp;$r&nbsp;*&nbsp;$f,&nbsp;($c+1)&nbsp;*&nbsp;$f,&nbsp;($r+1)&nbsp;*&nbsp;$f;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;@walls,&nbsp;'path'&nbsp;=&gt;&nbsp;[&nbsp;:$d,&nbsp;:$style&nbsp;];<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$h&nbsp;=&nbsp;0;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;^($!height-1)&nbsp;X&nbsp;^$!width&nbsp;-&gt;&nbsp;$r,&nbsp;$c&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;@!horizontal-walls[$h++]&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$d&nbsp;=&nbsp;sprintf&nbsp;'M&nbsp;%d&nbsp;%d&nbsp;L&nbsp;%d&nbsp;%d',<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$c&nbsp;*&nbsp;$f,&nbsp;($r+1)&nbsp;*&nbsp;$f,&nbsp;($c+1)&nbsp;*&nbsp;$f,&nbsp;($r+1)&nbsp;*&nbsp;$f;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;@walls,&nbsp;'path'&nbsp;=&gt;&nbsp;[&nbsp;:$d,&nbsp;:$style&nbsp;];<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;($x1,&nbsp;$x2,&nbsp;$x3)&nbsp;=&nbsp;$f,&nbsp;($!width&nbsp;&nbsp;-&nbsp;1)&nbsp;*&nbsp;$f,&nbsp;$!width&nbsp;&nbsp;*&nbsp;$f;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$y3&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$!height&nbsp;*&nbsp;$f;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;"M&nbsp;0&nbsp;0&nbsp;L&nbsp;0&nbsp;$y3",&nbsp;"M&nbsp;0&nbsp;0&nbsp;L&nbsp;$x2&nbsp;0",<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"M&nbsp;$x3&nbsp;0&nbsp;L&nbsp;$x3&nbsp;$y3",&nbsp;"M&nbsp;$x1&nbsp;$y3&nbsp;L&nbsp;$x3&nbsp;$y3"&nbsp;-&gt;&nbsp;$d&nbsp;{<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;@walls,&nbsp;'path'&nbsp;=&gt;&nbsp;[&nbsp;:$d,&nbsp;:$style&nbsp;];<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&gt;<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my&nbsp;$picture&nbsp;=&nbsp;svg&nbsp;=&gt;&nbsp;[<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:xmlns&lt;http://www.w3.org/2000/svg&gt;,<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:width($!width&nbsp;*&nbsp;$f),&nbsp;:height($!height&nbsp;*&nbsp;$f),<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@walls,<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;];<br>
&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;SVG.serialize($picture);<br>
&gt;&nbsp;&nbsp;&nbsp;}<br>
&gt;&nbsp;}<br>
</code>

</p><p>If you change the line <code>say $labyrinth;</code> to <code>say
$labyrinth.svg()</code>, you'll get the SVG version of the labyrinth instead of
the ASCII version. The output will look <a href="http://masak.org/carl/labyrint.svg" rel="nofollow">something like this</a>.
</p></div>
	
    

	<div class="journalpage">
		
		<br>
		<a href="//use.perl.org/journal.pl?op=list&amp;uid=6289" class="all">List all Journal entries</a>
	</div>
</div>

<!-- end template: ID 65, slashdot;journal;default -->

</div></div>

<!-- start template: ID 159, printCommentsMain;misc;default -->

<a name="acomments"></a>
<div class="commentwrap" id="commentwrap">

<div class="commentBox" style="font-size: 120%">
	<div>
<span class="escape-link"><a href="//use.perl.org/~masak/journal/39568" title="Back to Article - An introduction to maze-making (in Literate Perl 6)">An introduction to maze-making (in Literate Perl 6)</a></span>
<span class="commentBoxLinks"><a href="#" onclick="D2.ajaxFetchComments(0,1); return false"><span id="more_comments_num_d"></span> More</a> |

	<a href="//use.perl.org/login.pl" onclick="show_login_box(); return false">Login</a>



	| <a href="//use.perl.org/comments.pl?sid=43738&amp;op=reply&amp;threshold=0&amp;commentsort=0&amp;mode=thread" onclick="D2.replyTo(0); return false;">Reply</a></span>
	</div>
</div>

	<div class="commentBoxForm" id="commentControlBox">
<div></div>
	<div class="commentBox">
		<small>
		<b>The Fine Print:</b> The following comments are owned by whoever posted them.  We are not responsible for them in any way.
		</small>
<noscript><br><small>Without JavaScript enabled, you might want to
use <a href="//use.perl.org/comments.pl?sid=43738&amp;threshold=0&amp;commentsort=0&amp;mode=thread&amp;no_d2=1">the classic discussion system</a> instead.  If you <a href="//use.perl.org/login.pl">login</a>, you can remember this preference.
</small></noscript>
	</div>
	</div>
	
		<div id="d2out" class="horizontal">
		<div id="d2act" class="hide">
		<div class="loki" id="gods">
		<div class="block">
			<div class="title">

				<h4>
				
					<span class="h-inline">
					<a href="//use.perl.org/~masak/journal/39568" title="Back to Article - An introduction to maze-making (in Literate Perl 6)">An introduction to maze-making (in Literate Perl 6)</a></span>
					<span class="titlecount"><a href="//use.perl.org/~masak/journal/39568#topcomment" title="Back to Top Comment - An introduction to maze-making (in Literate Perl 6)"><span id="titlecountnum">6</span>&nbsp;Comments</a></span>
				
		<span class="ccw-header-links"><a href="#" onclick="D2.ajaxFetchComments(0,1); return false"><span id="more_comments_num_b"></span> More</a> |

	<a href="//use.perl.org/login.pl" onclick="show_login_box(); return false">Login</a>



	| <a href="//use.perl.org/comments.pl?sid=43738&amp;op=reply&amp;threshold=0&amp;commentsort=0&amp;mode=thread" onclick="D2.replyTo(0); return false;">Reply</a></span>
		<span id="d2toggle" title="Toggle window location" onclick="D2.toggleDisplayOptions()" class="close">/</span>
				</h4>
			</div>
		</div>
<script type="text/javascript">
gCommentControlWidget = null;

YAHOO.slashdot.ThresholdApp = function() {
  return {
    init: function() {
      gCommentControlWidget = new YAHOO.slashdot.ThresholdWidget('X');
      gCommentControlWidget.setTHT(D2.user_threshold(), D2.user_highlightthresh());
      D2.updateTotals();
    }
  };
}();

YAHOO.util.Event.addListener(window, "load", YAHOO.slashdot.ThresholdApp.init);
</script>
		<div id="bones">
      <div id="ccw">
        <div id="ccw-body" class="ccw-core">
          <div id="ccw-panel-container" class="ccw-core">
            <div id="ccw-full-panel" class="ccw-panel">
              <div class="ccw-panel-border"></div>
              <div id="ccw-full-count-pos" class="ccw-core-pos ccw-count-pos">
                <span id="ccw-full-count-text" class="ccw-count-text"><span id="currentFull"></span><span id="ccw-full-phrase">&nbsp;Full</span></span>
              </div>
            </div>
            <div id="ccw-abbr-panel" class="ccw-panel">
              <div class="ccw-panel-border"></div>
              <div id="ccw-abbr-count-pos" class="ccw-core-pos ccw-count-pos">
                <span id="ccw-abbr-count-text" class="ccw-count-text"><span id="currentOneline"></span><span id="ccw-abbr-phrase">&nbsp;Abbreviated</span></span>
              </div>
            </div>
            <div id="ccw-hide-panel" class="ccw-panel">
              <div id="ccw-hide-count-pos" class="ccw-core-pos ccw-count-pos">
                <span id="ccw-hide-count-text" class="ccw-count-text"><span id="currentHidden"></span><span id="ccw-hide-phrase">&nbsp;Hidden</span></span>
              </div>
            </div>
          </div>
    
          <div id="ccw-control" class="ccw-core">
            <div id="ccw-centering-rail" class="ccw-core">
              <div id="ccw-hide-bar-pos" class="ccw-core-pos">
                <div id="ccw-hide-bar" class="ccw-bar">
                  <div id="ccw-hide-bar-tab" class="ccw-bar-tab"></div>
                  <div id="ccw-hide-bar-upzone" class="ccw-upzone" onclick="gCommentControlWidget.stepTHT(HIDE_BAR, +1)"></div>
                  <div id="ccw-hide-bar-downzone" class="ccw-downzone" onclick="gCommentControlWidget.stepTHT(HIDE_BAR, -1)"></div>
                </div>
              </div>
              <div id="ccw-abbr-bar-pos" class="ccw-core-pos">
                <div id="ccw-abbr-bar" class="ccw-bar">
                  <div id="ccw-abbr-bar-tab" class="ccw-bar-tab"></div>
                  <div id="ccw-abbr-bar-upzone" class="ccw-upzone" onclick="gCommentControlWidget.stepTHT(ABBR_BAR, +1)"></div>
                  <div id="ccw-abbr-bar-downzone" class="ccw-downzone" onclick="gCommentControlWidget.stepTHT(ABBR_BAR, -1)"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
		</div>
		<div class="commentControlFooter"><a href="#" onclick="D2.ajaxFetchComments(0,1); return false"><span id="more_comments_num_c"></span> More</a> |

	<a href="//use.perl.org/login.pl" onclick="show_login_box(); return false">Login</a>



	| <a href="//use.perl.org/comments.pl?sid=43738&amp;op=reply&amp;threshold=0&amp;commentsort=0&amp;mode=thread" onclick="D2.replyTo(0); return false;">Reply</a><div id="login_cover" style="display:none" onclick="hide_login_box()"></div>
<div id="login_box" style="display:none">
<div class="generaltitle" >
	<div class="title">
		<h3 >
			Please Log In to Continue<a href="#" onclick="hide_login_box(); return false" class="close" title="Close this box"><img id="login_box_close" src="//images.use.perl.org/sic_close.png" alt="Close"></a>
			
		</h3>
	</div>
</div>
<div id="login_box_content">
<form action="//use.perl.org/login.pl" method="post">
<fieldset>
	<legend>Log In</legend>
	<label>
		Nickname
	</label>
	<input type="text" name="unickname" size="20" value="">
	<label>
		Password
	</label>
	<input type="hidden" name="returnto" value="//use.perl.org/comments.pl?sid=43738">
	<input type="hidden" name="op" value="userlogin">
	<input type="password" name="upasswd" size="20">
	<label class="checkbox">
		<input type="checkbox" name="login_temp" value="yes">
		Public Terminal
	</label>
	<input type="submit" name="userlogin" value="Log in" class="button">
	</fieldset>
</form>
<p>
	[ <b>
		<a href="//use.perl.org/login.pl?op=newuserform">
			Create a new account
		</a>
	</b> ]
</p>
</div></div>
<script type="text/javascript">logged_in = 0</script></div>
		<div id="commentControlBoxStatus" class="hide"><b>Loading... please wait.</b></div>
	</div>
</div>
		</div>
	
</div>
<a name="topcomment"></a>

<!-- end template: ID 159, printCommentsMain;misc;default -->



<!-- start template: ID 157, printCommComments;misc;default -->

<script src="//images.use.perl.org/comments.js?T_2_5_0_235" type="text/javascript"></script>
	<script type="text/javascript">
<!--
	D2.d2_keybindings_disable()[191] = 1;
	window.onscroll = D2.d2act;
	D2.boxStatus(1);
D2.comments({ 70453: { uid: 9133, pid: 0, read: 0, points: 1, kids: [ 70454 ], opid: 0 }, 70438: { uid: 8908, pid: 0, read: 0, points: 1, kids: [ 70446 ], opid: 0 }, 70446: { uid: 8908, pid: 70438, subject: "Re:Woow!", read: 0, points: 1, kids: [ 70452 ], opid: 70438 }, 70454: { uid: 6289, pid: 70453, subject: "Re:Very interesting", read: 0, points: 1, kids: [  ], opid: 70453 }, 70452: { uid: 6289, pid: 70446, read: 0, points: 1, kids: [  ], opid: 70446 }, 70457: { uid: 6289, pid: 0, read: 0, points: 1, kids: [  ], opid: 0 } });

D2.thresh_totals({6:{6:{1:6,3:0,2:0}},4:{6:{1:6,3:0,2:0},4:{1:6,3:0,2:0},5:{1:6,3:0,2:0}},1:{6:{1:0,3:0,2:6},4:{1:0,3:0,2:6},1:{1:0,3:6,2:0},3:{1:0,3:0,2:6},2:{1:0,3:3,2:3},5:{1:0,3:0,2:6}},3:{6:{1:6,3:0,2:0},4:{1:6,3:0,2:0},3:{1:6,3:0,2:0},5:{1:6,3:0,2:0}},0:{6:{1:0,3:0,2:6},4:{1:0,3:0,2:6},1:{1:0,3:6,2:0},3:{1:0,3:0,2:6},0:{1:0,3:6,2:0},2:{1:0,3:3,2:3},5:{1:0,3:0,2:6}},2:{6:{1:6,3:0,2:0},4:{1:6,3:0,2:0},3:{1:6,3:0,2:0},2:{1:6,3:0,2:0},5:{1:6,3:0,2:0}},5:{6:{1:6,3:0,2:0},5:{1:6,3:0,2:0}},"-1":{6:{1:0,3:0,2:6},4:{1:0,3:0,2:6},1:{1:0,3:6,2:0},3:{1:0,3:0,2:6},0:{1:0,3:6,2:0},2:{1:0,3:3,2:3},5:{1:0,3:0,2:6},"-1":{1:0,3:6,2:0}}});

D2.root_comment(0);
D2.root_comments([70438,70453,70457]);
D2.root_comments_hash({70453:1,70438:1,70457:1});

D2.d2_comment_order(0);
D2.user_uid(7);
D2.user_is_anon(1);
D2.user_is_admin(0);
D2.user_is_subscriber(0);
D2.user_threshold(0);
D2.user_highlightthresh(4);
D2.user_d2asp(0);

D2.discussion_id(43738);

D2.d2_seen('70438,8,6,1,1,3');
D2.more_comments_num(0);


//-->
	</script>




	
	
	
	
		<ul id="commentlisting" class="d2">
			<li id="tree_70438" class="comment">
<div id="comment_status_70438" class="commentstatus"></div>
<div id="comment_70438" class="oneline">

	<div id="comment_top_70438" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70438" name="comment_link_70438" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70438" onclick="return D2.setFocusComment(70438)">Woow!</a>
			
			<span id="comment_score_70438" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70438); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~ihrd/">ihrd (8908)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70438"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70438"><p>Cool post! I added your Perl6::Literate to the <a href="http://www.perlfoundation.org/perl6/index.cgi?perl6_modules_list" title="perlfoundation.org" rel="nofollow">http://www.perlfoundation.org/perl6/index.cgi?perl6_modules_list</a> [perlfoundation.org]</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70438"></div>

</div>


<div id="replyto_70438"></div>

<ul id="group_70438">
	<li id="hiddens_70438" class="hide"></li>
</ul><ul id="commtree_70438"><li id="tree_70446" class="comment">
<div id="comment_status_70446" class="commentstatus"></div>
<div id="comment_70446" class="oneline">

	<div id="comment_top_70446" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70446" name="comment_link_70446" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70446" onclick="return D2.setFocusComment(70446)">Re:</a>
			
			<span id="comment_score_70446" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70446); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~ihrd/">ihrd (8908)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70446"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70446"><p>Page name is changed:<br><a href="http://www.perlfoundation.org/perl6/index.cgi?perl6_apps_and_modules" title="perlfoundation.org" rel="nofollow">http://www.perlfoundation.org/perl6/index.cgi?perl6_apps_and_modules</a> [perlfoundation.org]</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70446"></div>

</div>


<div id="replyto_70446"></div>

<ul id="group_70446">
	<li id="hiddens_70446" class="hide"></li>
</ul><ul id="commtree_70446"><li id="tree_70452" class="comment">
<div id="comment_status_70452" class="commentstatus"></div>
<div id="comment_70452" class="oneline">

	<div id="comment_top_70452" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70452" name="comment_link_70452" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70452" onclick="return D2.setFocusComment(70452)">Nice, a list of apps</a>
			
			<span id="comment_score_70452" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70452); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~masak/">masak (6289)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70452"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70452"><p>That's a brave thing to do, knowing that the work required updating and maintaining that list by hand will only become harder and harder, and eventually impossible.<nobr> <wbr></nobr>:)</p><p>If you want ideas for things you might have missed in that list, the projects.list file in proto should be fairly comprehensive.</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70452"></div>

</div>


<div id="replyto_70452"></div>

<ul id="group_70452">
	<li id="hiddens_70452" class="hide"></li>
</ul></li></ul></li></ul></li><li id="tree_70453" class="comment">
<div id="comment_status_70453" class="commentstatus"></div>
<div id="comment_70453" class="oneline">

	<div id="comment_top_70453" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70453" name="comment_link_70453" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70453" onclick="return D2.setFocusComment(70453)">Very interesting</a>
			
			<span id="comment_score_70453" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70453); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~gilleain/">gilleain (9133)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70453"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70453"><p>You know, if you swap the word "labyrinth" for "molecule" and "cell" for "atom" and "wall" for "bond"....</p><p>The whole flattening hierarchy approach also sounds a bit like a data structure I read about on wikipedia called a "disjoint-set forest" (<a href="http://en.wikipedia.org/wiki/Disjoint-set_data_structure" title="wikipedia.org" rel="nofollow">link</a> [wikipedia.org]).</p><p>Anyway, it seems like the method works because labyrinths (and molecules!) have a restricted dimension. For labyrinths in 100 dimensions, the equivalence classes would have few members, and the complexity would again be closer to O(N^2). I guessing, of course<nobr> <wbr></nobr>:)</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70453"></div>

</div>


<div id="replyto_70453"></div>

<ul id="group_70453">
	<li id="hiddens_70453" class="hide"></li>
</ul><ul id="commtree_70453"><li id="tree_70454" class="comment">
<div id="comment_status_70454" class="commentstatus"></div>
<div id="comment_70454" class="oneline">

	<div id="comment_top_70454" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70454" name="comment_link_70454" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70454" onclick="return D2.setFocusComment(70454)">Re:</a>
			
			<span id="comment_score_70454" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70454); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~masak/">masak (6289)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70454"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70454"><p>Even in a moderately "small" labyrinth in 100 dimensions, the distinction between O(N) and O(N^2) won't be your biggest concern...<nobr> <wbr></nobr>:)</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70454"></div>

</div>


<div id="replyto_70454"></div>

<ul id="group_70454">
	<li id="hiddens_70454" class="hide"></li>
</ul></li></ul></li><li id="tree_70457" class="comment">
<div id="comment_status_70457" class="commentstatus"></div>
<div id="comment_70457" class="oneline">

	<div id="comment_top_70457" class="commentTop newcomment">
		<div class="title">
			
			<h4><a id="comment_link_70457" name="comment_link_70457" href="//use.perl.org/comments.pl?sid=43738&amp;cid=70457" onclick="return D2.setFocusComment(70457)">The reference to TAOCP</a>
			
			<span id="comment_score_70457" class="score">(<a href="#" onclick="getModalPrefs('modcommentlog', 'Moderation Comment Log', 70457); return false">Score:1</a>)</span></h4>
		</div>
		<div class="details">
			by
			<a href="//use.perl.org/~masak/">masak (6289)</a>
			
			
			<span class="otherdetails" id="comment_otherdetails_70457"></span>
		</div>
	</div>
	<div class="commentBody">
		<div id="comment_body_70457"><p>For people with their own copy of TAOCP, you'll find the algorithm used for <code>Cell.join</code> as Algorithm E in section 2.3.3. Knuth uses the word "parent" instead of "leader", and he checks for the case where cells A and B are the same cell, but otherwise the details match.</p></div>
		
	
	</div>
	<div class="commentSub" id="comment_sub_70457"></div>

</div>


<div id="replyto_70457"></div>

<ul id="group_70457">
	<li id="hiddens_70457" class="hide"></li>
</ul></li>
			<li id="roothiddens" class="hide"></li>
		</ul>
	
	
	
	


<div id="replyto_0"></div>


<div id="discussion_buttons">


<span class="nbutton"><p><b><a href="#" onclick="D2.ajaxFetchComments(0,1); return false"><span id="more_comments_num_a" class="hide">Get More Comments</span></a></b></p></span>



<span class="nbutton"><p><b><a href="//use.perl.org/comments.pl?sid=43738&amp;op=reply&amp;threshold=0&amp;commentsort=0&amp;mode=thread" onclick="D2.replyTo(0); return false;">Reply</a></b></p></span>







</div>



	<script type="text/javascript">
<!--
		D2.currents()['hidden']   = 0;
		D2.currents()['full']     = 0;
		D2.currents()['oneline']  = 6;
		// D2.currents_total(6);

		D2.abbrev_comments({});
		D2.noshow_comments([]);
		D2.pieces_comments([70438,70446,70452,70453,70454,70457]);
		D2.init_hiddens([]);

		D2.finishLoading();


		if (D2.thresh_totals()[6][6][1] == 0) {
			D2.replyTo(0, 1);
		}


//-->
	</script>

<!-- end template: ID 157, printCommComments;misc;default -->



<!-- start template: ID 112, footer;misc;default -->

</div>
                </div>
                <div id="footer">
			<div class="download">
                                <!-- START DOWNLOAD PERL -->
                                <!-- Perl Mongers, Inc.  web@perlmongers.org -->
                                <a href="http://www.cpan.org/ports/index.html"><img src="http://www.perl.org/Images/download_perl.gif" width="102" height="42" alt="Download Perl Now!"></a>
                                <!-- END DOWNLOAD PERL -->
                        </div>	
			<div class="sitelogo">
				<a href="//use.perl.org/">
					<img src="http://images.use.perl.org/topics/useperl.gif" alt="useperl">
				</a>
			</div>
                        <em>
				&nbsp; &nbsp; &gt; This made me wonder, suddenly: can telnet be written in perl?<BR>
&nbsp; &nbsp; Of course it can be written in Perl.&nbsp; Now if you'd said nroff,<BR>
&nbsp; &nbsp; that would be more challenging...&nbsp;  --Larry Wall
			</em>
		</div>
		<div class="copyright">
			Stories, comments, journals, and other submissions on use Perl; are Copyright 1998-2006, their respective owners.
		</div>
		<div class="btmnav">
			<ul>
	<li class="begin">
		<a href="//use.perl.org/faq.shtml">FAQ</a>
	</li>
	<li>
		<a href="//use.perl.org/about.shtml">About</a>
        </li>
        <li>
		<a href="//use.perl.org/submit.pl">Submit Story</a>
        </li>
        <li>
		<a href="//use.perl.org/search.pl">Older Stories</a>
        </li>
        <li>	
		<a href="//use.perl.org/topics.shtml">Topics</a>
        </li>
        <li>
		<a href="//use.perl.org/pollBooth.pl">Polls</a>
        </li>
        <li>
		<a href="//use.perl.org/journal.pl">Journals</a>
        </li>
        <li>
		<a href="//use.perl.org/authors.pl">Authors</a>
        </li>
        <li>
		<a href="//use.perl.org/modulelist/">New Modules</a>
        </li>
        <li>
		<a href="//use.perl.org/users.pl?op=edithome">Preferences</a>

        </li>
</ul>
		</div>
        </div>
<div id="modal_cover" style="display:none" onclick="hide_modal_box()"></div>
<div id="modal_box" style="display:none">
        <div class="generaltitle" >
                <div class="title"><h3><span id="preference_title"></span> <a href="#" onclick="hide_modal_box(); return false"><img src="//images.use.perl.org/sic_close.png" alt="Close"></a></h3></div>
        </div>
        <div id="modal_box_content"></div>
</div>

	<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-32013-15";
		urchinTracker();
	</script>

</body>
</html>

<!-- end template: ID 112, footer;misc;default -->

